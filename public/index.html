<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nutriway — Admin & FastDiet Edition</title>
    
    <!-- Tailwind CSS Config for Dark Mode -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        dark: {
                            bg: '#111827', // gray-900
                            card: '#1f2937', // gray-800
                            input: '#374151', // gray-700
                        }
                    }
                }
            }
        }
    </script>

    <!-- FontAwesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700;800&family=Roboto:wght=400;700&family=Open+Sans&family=Oswald&family=Pacifico&family=Lobster&family=Amatic+SC&family=Merriweather&family=Comfortaa&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Play&family=Inter&family=Poppins&family=Lato&family=Nunito&family=Raleway&family=Ubuntu&family=DM+Sans&family=Manrope&family=Bebas+Neue&family=Anton&family=Playfair+Display&family=Cinzel&family=Dancing+Script&family=Great+Vibes&family=Indie+Flower&family=JetBrains+Mono&family=Fira+Code&display=swap" rel="stylesheet">

    <style>
        /* --- 1. ГЛОБАЛЬНІ ЗМІННІ --- */
        :root {
            --primary: #10b981;
            --secondary: #3b82f6;
            --site-color-top: #059669;
            --site-color-bot: #2563eb;
            --site-gradient-angle: 135deg;
            --site-gradient: linear-gradient(var(--site-gradient-angle), var(--site-color-top) 0%, var(--site-color-bot) 100%);
        }

        body {
            font-family: 'Montserrat', sans-serif;
            scroll-behavior: smooth;
            overflow-x: hidden;
            /* Базові стилі для плавності зміни теми */
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        /* Клас для градієнтів */
        .hero-gradient-bg {
            background: var(--site-gradient) !important;
        }

        /* --- 2. СТИЛІ АНІМАЦІЙ --- */
        #mobile-menu {
            transition: transform 0.5s cubic-bezier(0.16, 1, 0.3, 1);
            transform: translateX(100%);
            box-shadow: -10px 0 30px rgba(0,0,0,0.1);
        }
        #mobile-menu.active { transform: translateX(0); }

        .menu-item { opacity: 0; transform: translateX(30px); transition: all 0.5s ease; }
        #mobile-menu.active .menu-item { opacity: 1; transform: translateX(0); }
        .delay-1 { transition-delay: 0.1s; }
        .delay-2 { transition-delay: 0.2s; }
        .delay-3 { transition-delay: 0.3s; }
        .delay-4 { transition-delay: 0.4s; }

        #menu-overlay {
            display: none; background: rgba(0,0,0,0.4); backdrop-filter: blur(4px);
            position: fixed; inset: 0; z-index: 40;
        }
        #menu-overlay.active { display: block; }

        .page-content { display: none; animation: fadeIn 0.4s ease-out; }
        .page-content.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.98); } to { opacity: 1; transform: scale(1); } }

        .info-card { transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .info-card:hover { transform: translateY(-10px); box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1); }

        /* --- 3. СТИЛІ АДМІНКИ --- */
        .movable-box {
            position: absolute; display: inline-block; cursor: grab;
            border: 1px dashed transparent; min-width: 50px; min-height: 50px; 
            z-index: 9000; /* Збільшений z-index для переднього плану */
        }
        .movable-box.selected-element, .card.selected-element, .selected-element, .selected-text {
            outline: 2px dashed #ffeb3b !important; outline-offset: 2px; 
            z-index: 9001; /* Ще вищий z-index при виборі */
        }
        .movable-content { width: 100%; height: 100%; overflow: hidden; }
        .resize-handle {
            width: 15px; height: 15px; background: white; border: 2px solid var(--primary);
            position: absolute; right: -7px; bottom: -7px; cursor: se-resize;
            display: none; 
            z-index: 9002; /* Вище ніж selected element */
        }
        .movable-box.selected-element .resize-handle { display: block; }

        #admin-panel {
            position: fixed; top: 0; right: -360px;
            width: 340px; height: 100vh;
            background: rgba(44, 62, 80, 0.98); 
            color: #ecf0f1; padding: 20px; 
            box-shadow: -5px 0 20px rgba(0,0,0,0.5);
            z-index: 9999; transition: right 0.4s ease;
            overflow-y: auto; font-family: 'Roboto', sans-serif;
        }
        #admin-panel.active { right: 0; }
        
        .admin-row { display: flex; gap: 10px; margin-bottom: 15px; }
        .btn-history { flex: 1; text-align: center; font-size: 1.2em; padding: 8px; background: #e67e22; border: none; border-radius: 5px; cursor: pointer; color: white; }
        .btn-tool { 
            background: #34495e; color: white; border: 1px solid #5d6d7e; 
            cursor: pointer; padding: 10px; margin-top: 5px; width: 100%; 
            text-align: left; border-radius: 5px; transition: 0.2s;
        }
        .btn-tool:hover { background: #415b76; transform: translateX(5px); }
        .admin-label { color: #bdc3c7; font-size: 0.8em; text-transform: uppercase; margin-top: 15px; display: block; }
        
        #admin-panel input[type="color"], #admin-panel input[type="number"], #admin-panel select, #admin-panel input[type="text"] {
            width: 100%; height: 35px; margin-top: 5px; border-radius: 4px; border: none; padding: 0 10px; color: #333;
        }

        #style-controls { opacity: 0.3; pointer-events: none; margin-top: 20px; border-top: 1px solid #555; padding-top: 10px;}
        #style-controls.active { opacity: 1; pointer-events: auto; }
        #card-style-controls, #hero-style-controls { display: none; margin-top: 15px; padding-top: 15px; border-top: 1px solid #444; }
        
        /* --- КАРТКИ --- */
        .card {
            --card-color-top: #667eea;
            --card-color-bot: #764ba2;
            background: linear-gradient(135deg, var(--card-color-top) 0%, var(--card-color-bot) 100%);
            width: 100%;
            max-width: 320px; 
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            overflow: hidden;
            color: white;
            transition: transform 0.3s ease;
            text-align: center;
            padding-bottom: 20px;
            margin: 10px;
        }
        .card:hover { transform: translateY(-5px); }
        .card-image {
            width: 100%; height: 200px; object-fit: cover;
            background-color: #ddd; pointer-events: none; 
        }
        .card-content h2 { margin: 15px 0 5px; font-size: 1.5em; }
        .card-content p { padding: 0 15px; opacity: 0.9; font-size: 0.95em; }

        /* HERO BANNER */
        .hero-banner-style {
            --hero-bg-top: #42a5f5;
            --hero-bg-bot: #26a69a;
            background: linear-gradient(90deg, var(--hero-bg-top), var(--hero-bg-bot));
            width: 100%; height: 100%;
            border-radius: 20px;
            position: relative;
            display: flex; flex-direction: column; 
            justify-content: center; align-items: center;
            color: white; text-align: center;
            box-shadow: inset 0 0 0 1px rgba(255,255,255,0.2), 0 5px 15px rgba(0,0,0,0.1); 
            padding: 20px;
            overflow: hidden;
            z-index: 9000;
        }
        .hero-banner-img {
            width: 100%; max-height: 150px; object-fit: cover; 
            border-radius: 10px; margin-bottom: 15px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        .hero-banner-style h2, .hero-banner-style p {
            position: relative; z-index: 2; text-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        .hero-banner-style::after {
            content: ''; position: absolute;
            top: 10px; left: 10px; right: 10px; bottom: 10px;
            border: 1px solid rgba(255,255,255,0.4); border-radius: 15px; pointer-events: none;
            z-index: 9000;
        }

        /* --- ВІТАМІНИ (із врахуванням темної теми) --- */
        .vit-item {
            display: flex; align-items: center; padding: 1rem;
            border-radius: 1rem;
            gap: 1rem; transition: transform 0.2s;
        }
        .vit-item:hover { transform: translateY(-2px); box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); }
        .vit-icon-box { font-size: 1.5rem; width: 3rem; text-align: center; }
        #disclaimer-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.85);
            z-index: 10000;
            display: flex; justify-content: center; align-items: center;
        }
        .disclaimer-box {
            background: rgb(47, 40, 40); padding: 30px; border-radius: 15px;
            max-width: 500px; text-align: center;
            box-shadow: 0 0 30px rgba(8, 169, 161, 0.3);
            animation: popIn 0.5s ease;
        }
        .disclaimer-btn {
            background: var(--primary); color: white;
            border: none; padding: 12px 30px; font-size: 18px;
            border-radius: 30px; cursor: pointer; margin-top: 20px;
            font-weight: bold; transition: 0.3s;
        }
        .disclaimer-btn:hover { transform: scale(1.05); background: #a09417; }
        /* --- Крапля --- */
        .water-drop {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #00C6FF, #0072FF);
            /* Магія форми: 0% з одного кута, 50% з інших */
            border-radius: 0 50% 50% 50%; 
            /* Повертаємо, щоб гострий кут був зверху */
            transform: rotate(45deg);
            margin: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        /* --- Склянка --- */
        .water-glass {
            width: 40px;
            height: 50px;
            border: 3px solid #333;
            border-top: none; /* Відкритий верх */
            border-radius: 0 0 10px 10px; /* Закруглене дно */
            position: relative;
            overflow: hidden; /* Щоб вода не витікала за межі */
            margin: 20px;
        }

        /* Вода всередині */
        .liquid {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 70%; /* Рівень води */
            background: linear-gradient(to top, #00C6FF, #0072FF);
            opacity: 0.8;
        }
        /* Міні-склянка для іконки */
        .mini-glass {
            width: 32px;
            height: 40px;
            border: 3px solid #3b82f6; /* Колір Blue-500 */
            border-top: none; /* Верх відкритий */
            border-radius: 0 0 10px 10px; /* Закруглене дно */
            position: relative;
            overflow: hidden;
            background-color: rgba(255, 255, 255, 0.1); /* Легкий фон скла */
        }

        /* Вода всередині */
        .liquid-fill {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 60%; /* Рівень води */
            background: linear-gradient(to top, #60a5fa, #3b82f6); /* Градієнт води */
            opacity: 0.9;
            
            /* Додамо легку анімацію */
            animation: slosh 3s infinite ease-in-out;
        }

        /* Анімація коливання води */
        @keyframes slosh {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(2px) rotate(2deg); }
        }
        /* Активний стан для світлої теми */
        .faq-item.active {
            border-color: #10b981;
            background-color: #f9fafb;
        }

        /* Активний стан для темної теми (dark mode) */
        html.dark .faq-item.active {
            background-color: #1f2937; /* Темніший відтінок (gray-800) */
            border-color: #10b981;
        }
        .faq-answer {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease-out, padding 0.3s ease;
        }
        .faq-item.active .faq-answer {
            max-height: 500px; /* Increased for long answers */
            padding-top: 1rem;
        }
        .faq-item.active i {
            transform: rotate(180deg);
        }
        .faq-item.active {
            border-color: #10b981;
            background-color: #f9fafb;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 flex flex-col min-h-screen transition-colors duration-300 dark:bg-gray-900 dark:text-gray-100">

    <div id="disclaimer-overlay">
        <div class="disclaimer-box">
            <h1 style="color: rgb(212, 55, 55);">УВАГА!</h1>
            <p style="margin: 15px 0; color: hsla(0, 76%, 60%, 0.725);">Вся інформація, розміщена на даному сайті, надається виключно з інформаційною та ознайомчою метою. Матеріали сайту не є медичною консультацією, не є діагнозом, не є рекомендацією до лікування, не є індивідуальним планом харчування та не можуть замінити консультацію лікаря, дієтолога або іншого кваліфікованого спеціаліста.</p>
            <p style="margin: 15px 0; color: hsla(0, 76%, 60%, 0.725);">Адміністрація сайту не несе відповідальності за будь-які наслідки, прямі або непрямі, що можуть виникнути в результаті використання інформації з цього сайту, включно (але не обмежуючись): змінами стану здоров’я, погіршенням самопочуття, алергічними реакціями, гормональними порушеннями, проблемами з травленням або іншими фізичними чи психологічними наслідками.</p>
            <button class="disclaimer-btn" onclick="closeDisclaimer()">Я підтверджую усе</button>
        </div>
    </div>


    <!-- Навігація -->
    <nav class="fixed top-0 left-0 right-0 z-[60] bg-white/90 backdrop-blur-md border-b border-gray-100 transition-colors duration-300 dark:bg-gray-900/90 dark:border-gray-800">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <div class="flex items-center space-x-2 cursor-pointer" onclick="showPage('home')">
                <i class="fas fa-route text-green-500 text-2xl"></i>
                <span class="text-xl font-bold tracking-tight text-gray-900 dark:text-white">Nutri<span class="text-green-500">way</span></span>
            </div>
            
            <div class="flex items-center gap-4">
                <!-- КНОПКА ЗМІНИ ТЕМИ -->
                <button id="theme-toggle" class="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-700 dark:text-yellow-400 transition transform hover:scale-110" title="Змінити тему">
                    <i class="fas fa-moon text-xl"></i>
                </button>

                <button onclick="toggleMenu()" class="p-2 focus:outline-none text-gray-900 dark:text-white hover:text-green-500 transition">
                    <i id="menu-icon" class="fas fa-bars text-2xl"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- Overlay -->
    <div id="menu-overlay" onclick="toggleMenu()"></div>

    <!-- Бургер Меню -->
    <div id="mobile-menu" class="fixed top-0 right-0 h-full z-50 bg-white dark:bg-gray-800 w-full sm:w-1/2 lg:w-1/4 flex flex-col p-8 pt-24 shadow-2xl">
        <div class="flex flex-col space-y-6 text-lg font-semibold text-gray-800 dark:text-gray-100">
            <a href="javascript:void(0)" onclick="showPage('home'); toggleMenu();" class="menu-item delay-1 hover:text-green-500 flex items-center space-x-4">
                <i class="fas fa-home w-6"></i> <span>Головна</span>
            </a>
            <a href="javascript:void(0)" onclick="showPage('calculator'); toggleMenu();" class="menu-item delay-2 hover:text-green-500 flex items-center space-x-4">
                <i class="fas fa-calculator w-6"></i> <span>Калькулятор</span>
            </a>
            <a href="javascript:void(0)" onclick="openAdminAuth(); toggleMenu();" class="menu-item delay-3 hover:text-red-500 flex items-center space-x-4 border-t border-gray-200 dark:border-gray-700 pt-4 mt-4">
                <i class="fas fa-cogs w-6"></i> <span>Адмін Панель</span>
            </a>
        </div>
    </div>

    <!-- MAIN CONTENT AREA -->
    <div id="content-area">

        <!-- ГОЛОВНА СТОРІНКА -->
        <main id="home-page" class="page-content active pt-16">
            <!-- Hero Section -->
            <header class="hero-gradient-bg text-white py-24 px-4 text-center relative overflow-hidden">
                <div class="container mx-auto relative z-10">
                    <h1 class="text-4xl md:text-6xl font-black mb-6 editable-text drop-shadow-md">Nutriway</h1>
                    <p class="text-lg opacity-90 mb-10 max-w-2xl mx-auto italic editable-text drop-shadow-sm">Ваш персональний шлях до здоров'я та ідеальної форми.</p>
                    <div class="flex justify-center gap-4">
                        <button onclick="showPage('calculator')" class="bg-white text-blue-600 px-8 py-3 rounded-full font-bold hover:shadow-xl transition hover:scale-105">Почати розрахунок</button>
                    </div>
                </div>
            </header>

            <!-- Діагностика -->
            <section class="py-20 container mx-auto px-4">
                <h2 class="text-3xl font-bold mb-12 text-center editable-text dark:text-white">Комплексна діагностика</h2>
                <div id="diag-grid" class="grid md:grid-cols-2 lg:grid-cols-4 gap-6 mb-24 text-center">
                    <!-- Cards with Dark Mode Support -->
                    <div class="p-6 bg-white dark:bg-gray-800 dark:border-gray-700 rounded-3xl shadow-md border border-gray-100 info-card transition-colors duration-300">
                        <i class="fas fa-heartbeat text-red-500 text-3xl mb-4"></i>
                        <h3 class="font-bold mb-2 editable-text dark:text-white">ІМТ</h3>
                        <p class="text-sm text-gray-500 dark:text-gray-400 editable-text">Оцінка маси тіла.</p>
                    </div>
                    <div class="p-6 bg-white dark:bg-gray-800 dark:border-gray-700 rounded-3xl shadow-md border border-gray-100 info-card transition-colors duration-300">
                        <i class="fas fa-fire text-orange-500 text-3xl mb-4"></i>
                        <h3 class="font-bold mb-2 editable-text dark:text-white">Калорії</h3>
                        <p class="text-sm text-gray-500 dark:text-gray-400 editable-text">Розрахунок норми.</p>
                    </div>
                    <div class="p-6 bg-white dark:bg-gray-800 dark:border-gray-700 rounded-3xl shadow-md border border-gray-100 info-card transition-colors duration-300">
                        <i class="fas fa-pills text-purple-500 text-3xl mb-4"></i>
                        <h3 class="font-bold mb-2 editable-text dark:text-white">Вітаміни</h3>
                        <p class="text-sm text-gray-500 dark:text-gray-400 editable-text">Підбір нутрієнтів.</p>
                    </div>
                    <div class="p-6 bg-white dark:bg-gray-800 dark:border-gray-700 rounded-3xl shadow-md border border-gray-100 info-card transition-colors duration-300">
                        <i class="fas fa-bed text-blue-500 text-3xl mb-4"></i>
                        <h3 class="font-bold mb-2 editable-text dark:text-white">Сон</h3>
                        <p class="text-sm text-gray-500 dark:text-gray-400 editable-text">Норми відпочинку.</p>
                    </div>
                </div>

                <!-- СВІТ NUTRIWAY -->
                <div class="space-y-24">
                    <div class="max-w-4xl mx-auto text-center">
                        <h2 class="text-4xl font-black text-gray-900 dark:text-white mb-4 editable-text">Світ Nutriway</h2>
                        <p class="text-gray-500 dark:text-gray-400 text-lg editable-text">Глибоке розуміння вашого тіла.</p>
                    </div>

                    <div class="grid lg:grid-cols-2 gap-8 items-stretch">
                        <div class="info-card bg-white dark:bg-gray-800 border border-gray-100 dark:border-gray-700 p-8 md:p-12 rounded-[3rem] shadow-sm flex flex-col md:flex-row gap-8 items-center transition-colors duration-300">
                            <div class="w-24 h-24 bg-green-100 dark:bg-green-900/30 rounded-3xl flex items-center justify-center shrink-0">
                                <i class="fas fa-seedling text-green-600 dark:text-green-400 text-4xl"></i>
                            </div>
                            <div>
                                <h3 class="text-2xl font-bold mb-3 editable-text dark:text-white">Нутриціологія</h3>
                                <p class="text-gray-600 dark:text-gray-300 leading-relaxed text-sm editable-text">Ми вивчаємо, як кожен нутрієнт впливає на енергію.</p>
                            </div>
                        </div>

                        <div class="info-card bg-gray-900 dark:bg-black p-8 md:p-12 rounded-[3rem] text-white shadow-xl flex flex-col md:flex-row gap-8 items-center border border-transparent dark:border-gray-800">
                            <div class="w-24 h-24 bg-white/10 rounded-3xl flex items-center justify-center shrink-0">
                                <i class="fas fa-utensils text-green-400 text-4xl"></i>
                            </div>
                            <div>
                                <h3 class="text-2xl font-bold mb-3 editable-text">Розумна Дієта</h3>
                                <p class="text-gray-300 leading-relaxed text-sm editable-text">Правило 80/20: 80% корисної їжі та 20% для душі.</p>
                            </div>
                        </div>
                    </div>

                     <!-- Тарілка здоров'я -->
                    <div class="bg-blue-500 p-12 rounded-[3rem] text-white shadow-lg overflow-hidden relative">
                    <i class="fas fa-tint absolute -right-10 -bottom-10 text-[12rem] opacity-10"></i>
                    <div class="relative z-10 flex flex-col md:flex-row items-center gap-10">
                        <div class="md:w-1/3">
                            <h3 class="text-3xl font-black mb-4">Гідратація — це база</h3>
                            <p class="opacity-80 leading-relaxed">Вода регулює температуру тіла, виводить токсини та покращує роботу мозку. Навіть 2% дефіциту води знижують вашу продуктивність наполовину.</p>
                        </div>
                        <div class="md:w-2/3 grid grid-cols-1 sm:grid-cols-3 gap-6">
                            <div class="bg-white/10 p-6 rounded-2xl backdrop-blur-md">
                                <h4 class="font-bold text-xl mb-2">30-40 мл</h4>
                                <p class="text-xs opacity-70 italic">на 1 кг ваги — ваша ідеальна норма чистої води на добу.</p>
                            </div>
                            <div class="bg-white/10 p-6 rounded-2xl backdrop-blur-md">
                                <h4 class="font-bold text-xl mb-2">Склянка зранку</h4>
                                <p class="text-xs opacity-70 italic">одразу після пробудження, щоб "запустити" травну систему.</p>
                            </div>
                            <div class="bg-white/10 p-6 rounded-2xl backdrop-blur-md">
                                <h4 class="font-bold text-xl mb-2">Без цукру</h4>
                                <p class="text-xs opacity-70 italic">кава та соки — це їжа, а не вода. Віддавайте перевагу чистому ресурсу.</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="container mx-auto px-4 max-w-4xl">
                <div class="text-center mb-16">
                    <h2 class="text-4xl font-black text-gray-900 mb-4">Енциклопедія Nutriway</h2>
                    <p class="text-gray-500 italic">Ми зібрали відповіді на найскладніші та найважливіші питання про здоров’я</p>
                </div>
                    <div class="space-y-4">
                        <!-- 1 -->
                        <div class="faq-item border border-gray-100 rounded-[2rem] p-8 transition-colors duration-300 dark:bg-gray-800 dark:border-gray-700" onclick="this.classList.toggle('active')">
                            <div class="flex justify-between items-center">
                                <h4 class="font-bold text-lg dark:text-white">● Чи справді потрібно пити 2 літри води?</h4>
                                <i class="fas fa-plus text-green-500 transition-transform"></i>
                            </div>

                            <div class="faq-answer text-gray-600 leading-relaxed dark:text-gray-300">
                                Ні, концепція «2 літри» є застарілою...
                            </div>
                        </div>
                                                <!-- 2 -->
                        <div class="faq-item border border-gray-100 rounded-[2rem] p-8 transition-colors duration-300 dark:bg-gray-800 dark:border-gray-700" onclick="this.classList.toggle('active')">
                            <div class="flex justify-between items-center">
                                <h4 class="font-bold text-lg">● Яка роль вуглеводів у процесі схуднення?</h4>
                                <i class="fas fa-plus text-green-500 transition-transform"></i>
                            </div>
                            <div class="faq-answer text-gray-600 leading-relaxed">
                                Вуглеводи — це основне паливо для мозку та м'язів. Повна відмова від них призводить до занепаду сил та гормональних збоїв. Ключ до успіху — у виборі «складних» вуглеводів (цільні крупи, овочі) та обмеженні «простих» (цукор, біле борошно). Складні вуглеводи мають низький глікемічний індекс, забезпечують довге відчуття ситості та запобігають різким стрибкам інсуліну.
                            </div>
                        </div>
                        <!-- 3 -->
                        <div class="faq-item border border-gray-100 rounded-[2rem] p-8 transition-colors duration-300 dark:bg-gray-800 dark:border-gray-700" onclick="this.classList.toggle('active')">
                            <div class="flex justify-between items-center">
                                <h4 class="font-bold text-lg">● Чи можна їсти фрукти ввечері?</h4>
                                <i class="fas fa-plus text-green-500 transition-transform"></i>
                            </div>
                            <div class="faq-answer text-gray-600 leading-relaxed">
                                Бажано вживати фрукти у першій половині дня або як перекус між сніданком та обідом. Фрукти містять фруктозу, яка при надлишку енергії ввечері може легше перетворюватися на жирові запаси печінки. Якщо дуже хочеться солодкого ввечері, краще обрати ягоди (лохина, малина), оскільки вони мають значно менше цукру та більше антиоксидантів.
                            </div>
                        </div>
                        <!-- 4 -->
                        <div class="faq-item border border-gray-100 rounded-[2rem] p-8 transition-colors duration-300 dark:bg-gray-800 dark:border-gray-700" onclick="this.classList.toggle('active')">
                            <div class="flex justify-between items-center">
                                <h4 class="font-bold text-lg">● Чому вага може «стояти» на місці при дієті?</h4>
                                <i class="fas fa-plus text-green-500 transition-transform"></i>
                            </div>
                            <div class="faq-answer text-gray-600 leading-relaxed">
                                Це явище називається «плато». Причини можуть бути різними: адаптація метаболізму до низької калорійності (тіло починає економити енергію), затримка води через стрес (кортизол), або зростання м'язової маси при одночасному спалюванні жиру (об'єми зменшуються, а вага ні). У такому разі ми рекомендуємо змінити тип тренувань або зробити невеликий «рефіл» — контрольоване збільшення калорій на 1–2 дні.
                            </div>
                        </div>
                        <!-- 5 -->
                        <div class="faq-item border border-gray-100 rounded-[2rem] p-8 transition-colors duration-300 dark:bg-gray-800 dark:border-gray-700" onclick="this.classList.toggle('active')">
                            <div class="flex justify-between items-center">
                                <h4 class="font-bold text-lg">● Чи безпечне інтервальне голодування (16/8)?</h4>
                                <i class="fas fa-plus text-green-500 transition-transform"></i>
                            </div>
                            <div class="faq-answer text-gray-600 leading-relaxed">
                                Для більшості здорових дорослих це ефективний інструмент контролю ваги та запуску процесів аутофагії (оновлення клітин). Проте є суворі протипоказання: захворювання жовчного міхура, гастрит, діабет 1 типу, вагітність та розлади харчової поведінки. Завжди консультуйтеся з лікарем перед переходом на такий режим.
                            </div>
                        </div>
                        <!-- 6 -->
                        <div class="faq-item border border-gray-100 rounded-[2rem] p-8 transition-colors duration-300 dark:bg-gray-800 dark:border-gray-700" onclick="this.classList.toggle('active')">
                            <div class="flex justify-between items-center">
                                <h4 class="font-bold text-lg">● Як відрізнити справжній голод від емоційного?</h4>
                                <i class="fas fa-plus text-green-500 transition-transform"></i>
                            </div>
                            <div class="faq-answer text-gray-600 leading-relaxed">
                                Справжній голод приходить поступово, відчувається фізично (бурчання в животі) і ви готові з'їсти навіть звичайну кашу чи салат. Емоційний голод виникає раптово, часто через стрес чи нудьгу, і він завжди «специфічний» — хочеться саме піци, шоколаду чи чіпсів. Спробуйте випити склянку води: якщо через 15 хвилин бажання їсти не зникло — це фізіологічна потреба.
                            </div>
                        </div>
                        <!-- 7 -->
                        <div class="faq-item border border-gray-100 rounded-[2rem] p-8 transition-colors duration-300 dark:bg-gray-800 dark:border-gray-700" onclick="this.classList.toggle('active')">
                            <div class="flex justify-between items-center">
                                <h4 class="font-bold text-lg">● Чи потрібно приймати БАДи щодня?</h4>
                                <i class="fas fa-plus text-green-500 transition-transform"></i>
                            </div>
                            <div class="faq-answer text-gray-600 leading-relaxed">
                                В ідеальному світі ми мали б отримувати все з їжі. Проте сучасні продукти часто збіднені на нутрієнти. Базовими для більшості є Вітамін D3 (особливо взимку) та Омега-3. Всі інші добавки (магній, залізо, цинк) слід приймати тільки після здачі аналізів, оскільки гіпервітаміноз може бути так само небезпечним, як і дефіцит.
                            </div>
                        </div>
                        <!-- 8 -->
                        <div class="faq-item border border-gray-100 rounded-[2rem] p-8 transition-colors duration-300 dark:bg-gray-800 dark:border-gray-700" onclick="this.classList.toggle('active')">
                            <div class="flex justify-between items-center">
                                <h4 class="font-bold text-lg">● Яка роль сну в жироспалюванні?</h4>
                                <i class="fas fa-plus text-green-500 transition-transform"></i>
                            </div>
                            <div class="faq-answer text-gray-600 leading-relaxed">
                                Сон — це час, коли виробляється соматотропін (гормон росту), який є найпотужнішим жироспалювачем. Недосип підвищує рівень греліну (гормону голоду) та знижує лептин (гормон ситості). Якщо ви спите менше 6 годин, ви схильні споживати на 300–500 ккал більше наступного дня просто через гормональний дисбаланс.
                            </div>
                        </div>
                        <!-- 9 -->
                        <div class="faq-item border border-gray-100 rounded-[2rem] p-8 transition-colors duration-300 dark:bg-gray-800 dark:border-gray-700" onclick="this.classList.toggle('active')">
                            <div class="flex justify-between items-center">
                                <h4 class="font-bold text-lg">● Чи можна пити каву під час дієти?</h4>
                                <i class="fas fa-plus text-green-500 transition-transform"></i>
                            </div>
                            <div class="faq-answer text-gray-600 leading-relaxed">
                                Сама по собі чорна кава без цукру містить майже 0 калорій і навіть може прискорити метаболізм. Проблеми починаються з додатками: сиропи, вершки, молоко та цукор перетворюють напій на повноцінний десерт (до 400 ккал). Також не рекомендується пити каву натщесерце, щоб не подразнювати слизову оболонку шлунка.
                            </div>
                        </div>
                        <!-- 10 -->
                        <div class="faq-item border border-gray-100 rounded-[2rem] p-8 transition-colors duration-300 dark:bg-gray-800 dark:border-gray-700" onclick="this.classList.toggle('active')">
                            <div class="flex justify-between items-center">
                                <h4 class="font-bold text-lg">● Як почати вести ЗСЖ і не кинути через тиждень?</h4>
                                <i class="fas fa-plus text-green-500 transition-transform"></i>
                            </div>
                            <div class="faq-answer text-gray-600 leading-relaxed">
                                Не намагайтеся змінити все за один день. Використовуйте тактику «малих кроків»: перший тиждень просто пийте норму води. Другий тиждень — додайте овочі до кожного прийому їжі. Третій — почніть гуляти 30 хвилин ввечері. Наш мозок боїться різких змін, але легко адаптується до поступових покращень. Nutriway створений саме для такої плавної та комфортної трансформації.
                            </div>
                        </div>
                    </div>
                </div>
                </div>
            </section>  
        </main>

        <!-- КАЛЬКУЛЯТОР -->
        <main id="calculator-page" class="page-content pt-32 pb-20">
            <div class="container mx-auto px-4 max-w-5xl">
                <h2 class="text-4xl font-black text-center mb-12 editable-text dark:text-white">Калькулятор</h2>
                
                <div class="grid lg:grid-cols-1 gap-8">
                    <!-- INPUT FORM -->
                    <div class="bg-white dark:bg-gray-800 rounded-[2rem] p-8 shadow-xl border border-gray-100 dark:border-gray-700 max-w-3xl mx-auto w-full transition-colors duration-300">
                        <h3 class="font-bold text-gray-900 dark:text-white mb-6 flex items-center text-xl">
                            <i class="fas fa-user-edit mr-3 text-green-500"></i> Ваші параметри
                        </h3>
                        
                        <div class="grid md:grid-cols-3 gap-6 mb-6">
                            <div>
                                <label class="text-xs font-bold text-gray-400 mb-2 block ml-1">ВІК (років)</label>
                                <input id="age" type="number" placeholder="25" class="w-full p-4 bg-gray-50 dark:bg-gray-700 dark:text-white rounded-2xl outline-none focus:ring-2 focus:ring-green-400 transition">
                            </div>
                            <div>
                                <label class="text-xs font-bold text-gray-400 mb-2 block ml-1">ЗРІСТ (см)</label>
                                <input id="height" type="number" placeholder="175" class="w-full p-4 bg-gray-50 dark:bg-gray-700 dark:text-white rounded-2xl outline-none focus:ring-2 focus:ring-green-400 transition">
                            </div>
                            <div>
                                <label class="text-xs font-bold text-gray-400 mb-2 block ml-1">ВАГА (кг)</label>
                                <input id="weight" type="number" placeholder="70" class="w-full p-4 bg-gray-50 dark:bg-gray-700 dark:text-white rounded-2xl outline-none focus:ring-2 focus:ring-green-400 transition">
                            </div>
                        </div>

                        <div class="grid md:grid-cols-2 gap-6 mb-6">
                            <div>
                                <label class="text-xs font-bold text-gray-400 mb-2 block ml-1">АЛЕРГІЇ</label>
                                <input id="allergy" type="text" placeholder="Горіхи, мед..." class="w-full p-4 bg-gray-50 dark:bg-gray-700 dark:text-white rounded-2xl outline-none focus:ring-2 focus:ring-green-400 transition">
                            </div>
                            <div>
                                <label class="text-xs font-bold text-gray-400 mb-2 block ml-1">ЗДОРОВ'Я</label>
                                <input id="health" type="text" placeholder="Травми..." class="w-full p-4 bg-gray-50 dark:bg-gray-700 dark:text-white rounded-2xl outline-none focus:ring-2 focus:ring-green-400 transition">
                            </div>
                        </div>

                        <div class="mb-6">
                            <label class="text-xs font-bold text-gray-400 mb-2 block ml-1">СТАТЬ</label>
                            <div class="flex gap-4">
                                <label class="flex-1 cursor-pointer">
                                    <input type="radio" name="gender" value="male" checked class="peer hidden">
                                    <div class="p-3 rounded-xl bg-gray-50 dark:bg-gray-700 dark:text-gray-300 text-center border-2 border-transparent peer-checked:border-green-500 peer-checked:bg-green-50 dark:peer-checked:bg-green-900/30 peer-checked:text-green-700 dark:peer-checked:text-green-400 transition font-bold text-sm">Чоловік</div>
                                </label>
                                <label class="flex-1 cursor-pointer">
                                    <input type="radio" name="gender" value="female" class="peer hidden">
                                    <div class="p-3 rounded-xl bg-gray-50 dark:bg-gray-700 dark:text-gray-300 text-center border-2 border-transparent peer-checked:border-green-500 peer-checked:bg-green-50 dark:peer-checked:bg-green-900/30 peer-checked:text-green-700 dark:peer-checked:text-green-400 transition font-bold text-sm">Жінка</div>
                                </label>
                            </div>
                        </div>

                        <div class="mb-8">
                            <label class="text-xs font-bold text-gray-400 mb-2 block ml-1">АКТИВНІСТЬ</label>
                            <div class="grid grid-cols-3 sm:grid-cols-5 gap-2">
                                <!-- Reusable Radio Class -->
                                <label class="cursor-pointer">
                                    <input type="radio" name="activity" value="low" class="peer hidden">
                                    <div class="p-2 rounded-lg bg-gray-50 dark:bg-gray-700 dark:text-gray-300 text-center text-xs font-bold border dark:border-gray-600 peer-checked:bg-green-500 peer-checked:text-white transition">Низька</div>
                                </label>
                                <label class="cursor-pointer">
                                    <input type="radio" name="activity" value="small" class="peer hidden">
                                    <div class="p-2 rounded-lg bg-gray-50 dark:bg-gray-700 dark:text-gray-300 text-center text-xs font-bold border dark:border-gray-600 peer-checked:bg-green-500 peer-checked:text-white transition">Мала</div>
                                </label>
                                <label class="cursor-pointer">
                                    <input type="radio" name="activity" value="medium" checked class="peer hidden">
                                    <div class="p-2 rounded-lg bg-gray-50 dark:bg-gray-700 dark:text-gray-300 text-center text-xs font-bold border dark:border-gray-600 peer-checked:bg-green-500 peer-checked:text-white transition">Середня</div>
                                </label>
                                <label class="cursor-pointer">
                                    <input type="radio" name="activity" value="high" class="peer hidden">
                                    <div class="p-2 rounded-lg bg-gray-50 dark:bg-gray-700 dark:text-gray-300 text-center text-xs font-bold border dark:border-gray-600 peer-checked:bg-green-500 peer-checked:text-white transition">Висока</div>
                                </label>
                                <label class="cursor-pointer">
                                    <input type="radio" name="activity" value="very_high" class="peer hidden">
                                    <div class="p-2 rounded-lg bg-gray-50 dark:bg-gray-700 dark:text-gray-300 text-center text-xs font-bold border dark:border-gray-600 peer-checked:bg-green-500 peer-checked:text-white transition">Спорт</div>
                                </label>
                            </div>
                        </div>

                        <button onclick="showData()" class="w-full py-4 bg-gradient-to-r from-blue-500 to-green-500 text-white font-bold rounded-2xl shadow-lg hover:shadow-xl hover:scale-[1.02] transition transform">
                            РОЗРАХУВАТИ
                        </button>
                        
                        <!-- Confirmation Buttons -->
                        <div id="confirm-buttons" class="hidden mt-4 flex gap-4">
                             <button onclick="clearResult(); showData();" class="flex-1 py-3 bg-green-500 text-white rounded-xl font-bold hover:bg-green-600">Дані вірні</button>
                             <button onclick="reTry()" class="flex-1 py-3 bg-red-500 text-white rounded-xl font-bold hover:bg-red-600">Виправити</button>
                        </div>
                    </div>

                    <!-- RESULTS AREA -->
                    <div id="resultArea" class="hidden animate-in fade-in slide-in-from-bottom-4 duration-500 space-y-8 max-w-3xl mx-auto w-full">
                        
                        <!-- Main Stats -->
                        <div id="macros-section" class="bg-white dark:bg-gray-800 rounded-[2rem] p-8 border border-gray-100 dark:border-gray-700 shadow-xl hidden transition-colors duration-300">
                            <h4 class="font-bold text-gray-900 dark:text-white mb-6 flex items-center text-xl">
                                <i class="fas fa-chart-pie mr-3 text-blue-500"></i> Основні показники
                            </h4>
                            <div id="macros-grid-container" class="grid grid-cols-2 md:grid-cols-4 gap-4">
                                <!-- Macros injected by JS -->
                            </div>
                            
                            <!-- IMT & Text Info -->
                            <div class="mt-6 p-6 bg-gray-50 dark:bg-gray-700/50 rounded-2xl border border-gray-200 dark:border-gray-600">
                                <div id="imt-display">
                                    <!-- IMT will be injected here -->
                                </div>
                                <div id="text-info" class="mt-4 text-sm text-gray-600 dark:text-gray-300 whitespace-pre-wrap leading-relaxed"></div>
                            </div>
                        </div>

                        <!-- Sleep Card -->
                        <div id="sleep-section" class="bg-white dark:bg-gray-800 rounded-[2rem] p-8 border border-gray-100 dark:border-gray-700 shadow-xl hidden transition-colors duration-300">
                            <h4 class="font-bold text-gray-900 dark:text-white mb-6 flex items-center text-xl">
                                <i class="fas fa-bed mr-3 text-indigo-500"></i> Рекомендований сон
                            </h4>
                            <div class="flex items-center p-4 bg-indigo-50 dark:bg-indigo-900/20 rounded-2xl border border-indigo-100 dark:border-indigo-800">
                                <div class="text-3xl text-indigo-500 mr-4"><i class="fas fa-moon"></i></div>
                                <div>
                                    <div class="text-xs text-gray-500 dark:text-gray-400 font-bold uppercase">Тривалість</div>
                                    <div id="sleep-value" class="text-xl font-bold text-gray-900 dark:text-white"></div>
                                </div>
                            </div>
                        </div>
                        <!-- Water Card -->
                        <div id="water-section" class="bg-white dark:bg-gray-800 rounded-[2rem] p-8 border border-gray-100 dark:border-gray-700 shadow-xl hidden transition-colors duration-300">
    
                            <h4 class="font-bold text-gray-900 dark:text-white mb-6 flex items-center text-xl">
                                <i class="fas fa-tint mr-3 text-blue-500 text-2xl"></i> 
                                Рекомендована кількість води
                            </h4>

                            <div class="flex items-center p-4 bg-blue-50 dark:bg-blue-900/20 rounded-2xl border border-blue-100 dark:border-blue-800">
                                
                                <div class="mini-glass mr-4">
                                    <div class="liquid-fill"></div>
                                </div>

                                <div>
                                    <div class="text-xs text-gray-500 dark:text-gray-400 font-bold uppercase">Кількість</div>
                                    <div id="water-value" class="text-xl font-bold text-gray-900 dark:text-white"></div>
                                </div>
                            </div>
                        </div>

                        <!-- Vitamin Cards -->
                        <div id="vitamin-section" class="bg-white dark:bg-gray-800 rounded-[2rem] p-8 border border-gray-100 dark:border-gray-700 shadow-xl hidden transition-colors duration-300">
                            <h4 class="font-bold text-gray-900 dark:text-white mb-6 flex items-center text-xl">
                                <i class="fas fa-capsules mr-3 text-purple-500"></i> Ваша вітамінна карта
                            </h4>
                            <div id="vitamin-grid-container" class="grid md:grid-cols-2 gap-4">
                                <!-- Cards injected by JS -->
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </main>

    </div>

    <!-- ADMIN PANEL -->
    <div id="admin-panel">
        <h3 class="text-xl font-bold mb-4 border-b border-gray-600 pb-2">⚙️ Адмін Панель</h3>
        <div class="admin-row">
            <button class="btn-history" id="btn-undo" title="Undo"><i class="fas fa-undo"></i></button>
            <button class="btn-history" id="btn-redo" title="Redo"><i class="fas fa-redo"></i></button>
        </div>
        <div id="site-style-controls">
            <span class="admin-label text-blue-400">🎨 Стилі Сайту (Градієнт)</span>
            <span class="admin-label">Колір Верх / Низ:</span>
            <div class="admin-row">
                <input type="color" id="site-color-top" value="#059669">
                <input type="color" id="site-color-bot" value="#2563eb">
            </div>
            <span class="admin-label">Кут (deg):</span>
            <input type="number" id="site-gradient-angle" value="135" min="0" max="360" step="5">
        </div>
        <span class="admin-label mt-6">Створення елементів</span>
        <button class="btn-tool" id="add-card-struct">📄 + Картка</button>
        <button class="btn-tool" id="add-float-text">💬 + Текст</button>
        <button class="btn-tool" id="add-float-img">🖼️ + Картинка</button>
        <button class="btn-tool" id="add-hero-banner">📢 + Банер (Hero)</button>
        <div id="style-controls">
            <span class="admin-label text-yellow-400">✏️ Редактор</span>
            <span class="admin-label">Розмір (px):</span>
            <input type="number" id="font-size-input" value="16">
            <span class="admin-label">Шрифт:</span>
            <select id="font-select"></select>
            <span class="admin-label">Колір тексту:</span>
            <input type="color" id="color-text">
            <span class="admin-label">Фон:</span>
            <div style="display: flex; gap: 5px;">
                <input type="color" id="color-bg" value="#ffffff">
                <button class="btn-tool" style="width: auto; margin: 5px 0 0;" id="btn-no-bg">X</button>
            </div>
            <div id="card-style-controls">
                <span class="admin-label text-purple-400">✨ Градієнт Картки</span>
                <span class="admin-label">Верхній колір:</span>
                <input type="color" id="card-color-top" value="#667eea">
                <span class="admin-label">Нижній колір:</span>
                <input type="color" id="card-color-bot" value="#764ba2">
                <span class="admin-label">Картинка (URL):</span>
                <input type="text" id="card-img-url" placeholder="URL картинки...">
            </div>
            <div id="hero-style-controls">
                <span class="admin-label text-red-400">🔥 Банер Градієнт</span>
                <span class="admin-label">Ліво / Право:</span>
                <div class="admin-row">
                    <input type="color" id="hero-grad-top" value="#42a5f5">
                    <input type="color" id="hero-grad-bot" value="#26a69a">
                </div>
                <span class="admin-label">Картинка зверху (URL):</span>
                <input type="text" id="hero-img-url" placeholder="URL картинки...">
            </div>
            <button class="btn-tool" style="background: #c0392b; margin-top: 20px;" id="btn-delete">🗑️ Видалити</button>
        </div>
        <button class="btn-tool" style="background: #7f8c8d; margin-top: 30px;" onclick="toggleAdmin(false)">Закрити</button>
    </div>

    <footer class="bg-white dark:bg-gray-900 border-t dark:border-gray-800 mt-auto text-center transition-colors duration-300 py-12">
        <div class="container mx-auto px-4">
            <div class="flex items-center justify-center space-x-2 mb-6">
                <i class="fas fa-route text-green-500"></i>
                <span class="text-xl font-bold text-gray-900 dark:text-white">Nutriway</span>
            </div>
            <p class="text-gray-400 dark:text-gray-600 text-[10px] font-bold uppercase tracking-[0.2em] editable-text">© 2025 Всі права захищені</p>
        </div>
    </footer>

    <script>
        // --- THEME LOGIC START ---
        const themeBtn = document.getElementById('theme-toggle');
        const themeIcon = themeBtn.querySelector('i');
        const htmlEl = document.documentElement;

        function applyTheme(isDark) {
            if (isDark) {
                htmlEl.classList.add('dark');
                themeIcon.classList.remove('fa-moon');
                themeIcon.classList.add('fa-sun');
            } else {
                htmlEl.classList.remove('dark');
                themeIcon.classList.remove('fa-sun');
                themeIcon.classList.add('fa-moon');
            }
        }

        // Init Check
        if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            applyTheme(true);
        } else {
            applyTheme(false);
        }

        themeBtn.addEventListener('click', () => {
            if (htmlEl.classList.contains('dark')) {
                localStorage.theme = 'light';
                applyTheme(false);
            } else {
                localStorage.theme = 'dark';
                applyTheme(true);
            }
        });
        // --- THEME LOGIC END ---

        // --- 1. NAV LOGIC ---
        function toggleMenu() {
            const menu = document.getElementById('mobile-menu');
            const overlay = document.getElementById('menu-overlay');
            const icon = document.getElementById('menu-icon');
            if (menu.classList.contains('active')) {
                menu.classList.remove('active');
                overlay.classList.remove('active');
                icon.className = "fas fa-bars text-2xl";
                document.body.style.overflow = "auto";
            } else {
                menu.classList.add('active');
                overlay.classList.add('active');
                icon.className = "fas fa-times text-2xl";
                document.body.style.overflow = "hidden";
            }
        }

        function showPage(pageId) {
            document.querySelectorAll('.page-content').forEach(p => p.classList.remove('active'));
            const page = document.getElementById(pageId + '-page');
            if(page) page.classList.add('active');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // --- 2. CALCULATOR LOGIC ---
        let ReTryBut = 0;

        function clearResult(){
          document.getElementById('confirm-buttons').classList.add('hidden');
          document.getElementById('resultArea').classList.add('hidden');
          document.getElementById('vitamin-section').classList.add('hidden');
          document.getElementById('macros-section').classList.add('hidden');
          document.getElementById('sleep-section').classList.add('hidden');
          document.getElementById('water-section').classList.add('hidden');
        }
      
        function reTry(){
          ReTryBut=0;
          clearResult();
        }

        function IMT(){
            const height = Number(document.getElementById('height').value);
            const weight = Number(document.getElementById('weight').value);
            if(!height||!weight) return NaN;
            return Number((weight/((height/100)**2)).toFixed(2));
        }

        function IMT_Interpretation(imt_value){
            if(!isFinite(imt_value)) return 'Немає даних';
            if(imt_value<16) return 'Виражений дефіцит';
            if(imt_value<18.5) return 'Дефіцит ваги';
            if(imt_value<25) return 'Норма';
            if(imt_value<30) return 'Предожиріння';
            return 'Ожиріння';
        }

        function BMR(age,height,weight,gender,activity){
            age=Number(age);height=Number(height);weight=Number(weight);
            const multipliers={very_high:1.9,high:1.725,medium:1.55,small:1.375,low:1.2};
            let bmr = (10*weight)+(6.25*height)-(5*age)+(gender==='male'?5:-161);
            return bmr*(multipliers[activity]??1.55);
        }

        function proteins(activity,weight){const m={very_high:2,high:1.8,medium:1.4,small:1.2,low:0.8}; return Number(weight)*(m[activity]??1.4)}
        function fat(brm_last){return (0.3*brm_last)/9}
        function carb(brm_last){return (0.4*brm_last)/4}

        function vitamins(age,gender,weight,activity){
            age=Number(age);weight=Number(weight);
            const multipliers={very_high:1.4,high:1.2,medium:1.1,small:1,low:0.8};
            const vitaminRDA={Vitamin_C:90,Vitamin_D:800,Vitamin_A:700,Vitamin_B1:1.1,Vitamin_B6:1.3,Vitamin_B12:2.4};
            const genderFactor={male:1,female:0.9};
            let ageFactor = age<=3?0.8:age<=8?0.9:age<=13?1:age<=18?1.1:age<=50?1:1.2;
            const activityMultiplier = multipliers[activity] ?? 1.1;
            const gFactor = genderFactor[gender] ?? 1;
            const weightFactor = (weight>0)?(weight/70):1;
            return {
            Vitamin_D: vitaminRDA.Vitamin_D * ageFactor * gFactor * activityMultiplier * weightFactor,
            Vitamin_C: vitaminRDA.Vitamin_C * ageFactor * gFactor * activityMultiplier * weightFactor,
            Vitamin_B12: vitaminRDA.Vitamin_B12 * ageFactor * gFactor * activityMultiplier * weightFactor,
            Vitamin_A: vitaminRDA.Vitamin_A * ageFactor * gFactor * activityMultiplier * weightFactor,
            Vitamin_B1: vitaminRDA.Vitamin_B1 * ageFactor * gFactor * activityMultiplier * weightFactor,
            Vitamin_B6: vitaminRDA.Vitamin_B6 * ageFactor * gFactor * activityMultiplier * weightFactor
            };
        }

        function getSleepRecommendation(age) {
            if (age >= 1 && age <= 2) return "13 годин";
            if (age >= 3 && age <= 5) return "12 годин";
            if (age >= 6 && age <= 13) return "10 годин";
            if (age >= 14 && age <= 17) return "9 годин";
            if (age >= 18 && age <= 25) return "8 годин";
            if (age >= 26 && age <= 64) return "8 годин";
            if (age >= 65) return "7 годин";
            if (age < 1 && age >= 0) return "14-17 годин (немовлята)";
            return "8 годин";
        }

        function getWaterRecommendation(weight) {
            const water = weight * 0.033;
            return water.toFixed(2) + " літрів";
        }

        function showData(){
            const ageRaw = document.getElementById('age').value;
            const heightRaw = document.getElementById('height').value;
            const weightRaw = document.getElementById('weight').value;
            const allergy = document.getElementById('allergy').value; 
            const health = document.getElementById('health').value;   

            const age = Number(ageRaw), height = Number(heightRaw), weight = Number(weightRaw);
            const gender = document.querySelector('input[name="gender"]:checked')?.value || 'male';
            const activity = document.querySelector('input[name="activity"]:checked')?.value || 'medium';
            
            if(!ageRaw||!heightRaw||!weightRaw){
                document.getElementById('resultArea').classList.remove('hidden');
                document.getElementById('text-info').innerText='Заповніть всі поля!';
                document.getElementById('macros-section').classList.remove('hidden');
                return;
            }

            if(((age>100||height>210||weight>200)||(age<=1||height<=35||weight<=2)) && ReTryBut==0){
                document.getElementById('resultArea').classList.remove('hidden');
                document.getElementById('macros-section').classList.remove('hidden');
                document.getElementById('text-info').innerText='Ви впевнені у даних? Значення виглядають підозріло.';
                document.getElementById('confirm-buttons').classList.remove('hidden');
                ReTryBut=1; 
                return;
            }

            ReTryBut=0;
            document.getElementById('confirm-buttons').classList.add('hidden');
            document.getElementById('resultArea').classList.remove('hidden');

            try{
                const bmrVal = BMR(age,height,weight,gender,activity);
                const imtVal = IMT();
                const sleepRec = getSleepRecommendation(age);
                const waterRec = getWaterRecommendation(weight);

                const calVal = Number(bmrVal).toFixed(0);
                const protVal = Number(proteins(activity,weight)).toFixed(0);
                const fatVal = Number(fat(bmrVal)).toFixed(0);
                const carbVal = Number(carb(bmrVal)).toFixed(0);

                const macrosHTML = `
                    <div class="flex flex-col items-center p-4 bg-orange-50 dark:bg-orange-900/20 rounded-2xl border border-orange-100 dark:border-orange-900/30">
                        <div class="text-orange-500 text-2xl mb-2"><i class="fas fa-fire"></i></div>
                        <div class="text-xs text-gray-500 dark:text-gray-400 font-bold uppercase">Калорії</div>
                        <div class="text-lg font-bold text-gray-900 dark:text-white">${calVal}</div>
                    </div>
                    <div class="flex flex-col items-center p-4 bg-blue-50 dark:bg-blue-900/20 rounded-2xl border border-blue-100 dark:border-blue-900/30">
                        <div class="text-blue-500 text-2xl mb-2"><i class="fas fa-dumbbell"></i></div>
                        <div class="text-xs text-gray-500 dark:text-gray-400 font-bold uppercase">Білки</div>
                        <div class="text-lg font-bold text-gray-900 dark:text-white">${protVal} г</div>
                    </div>
                    <div class="flex flex-col items-center p-4 bg-yellow-50 dark:bg-yellow-900/20 rounded-2xl border border-yellow-100 dark:border-yellow-900/30">
                        <div class="text-yellow-500 text-2xl mb-2"><i class="fas fa-tint"></i></div>
                        <div class="text-xs text-gray-500 dark:text-gray-400 font-bold uppercase">Жири</div>
                        <div class="text-lg font-bold text-gray-900 dark:text-white">${fatVal} г</div>
                    </div>
                    <div class="flex flex-col items-center p-4 bg-green-50 dark:bg-green-900/20 rounded-2xl border border-green-100 dark:border-green-900/30">
                        <div class="text-green-500 text-2xl mb-2"><i class="fas fa-bread-slice"></i></div>
                        <div class="text-xs text-gray-500 dark:text-gray-400 font-bold uppercase">Вуглеводи</div>
                        <div class="text-lg font-bold text-gray-900 dark:text-white">${carbVal} г</div>
                    </div>
                `;
                document.getElementById('macros-grid-container').innerHTML = macrosHTML;
                document.getElementById('macros-section').classList.remove('hidden');

                // --- NEW IMT LOGIC ---
                const imtStatus = IMT_Interpretation(imtVal);
                let statusColorClass = 'text-gray-700';
                let statusBgClass = 'bg-gray-100';

                // Вибір кольору залежно від значення ІМТ
                if (imtVal < 18.5) {
                    // Недостатня вага - Синій
                    statusColorClass = 'text-blue-600';
                    statusBgClass = 'bg-blue-100 dark:bg-blue-900/30';
                } else if (imtVal < 25) {
                    // Норма - Зелений
                    statusColorClass = 'text-green-600';
                    statusBgClass = 'bg-green-100 dark:bg-green-900/30';
                } else if (imtVal < 30) {
                    // Предожиріння - Помаранчевий
                    statusColorClass = 'text-orange-500';
                    statusBgClass = 'bg-orange-100 dark:bg-orange-900/30';
                } else {
                    // Ожиріння - Червоний
                    statusColorClass = 'text-red-600';
                    statusBgClass = 'bg-red-100 dark:bg-red-900/30';
                }

                document.getElementById('imt-display').innerHTML = `
                    <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4">
                        <span class="text-xl font-bold dark:text-gray-200">ІМТ: <span class="text-2xl">${imtVal}</span></span>
                        <span class="px-4 py-2 rounded-xl font-bold border ${statusColorClass} ${statusBgClass} border-current shadow-sm transition-all duration-300">
                            ${imtStatus}
                        </span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-3 mt-4 dark:bg-gray-700 overflow-hidden shadow-inner">
                         <!-- Лінія прогресу (макс 100% ширини, scale на 40, бо ІМТ > 40 це вже багато) -->
                        <div class="h-3 rounded-full transition-all duration-1000 ease-out ${statusColorClass.replace('text-', 'bg-')}" style="width: ${Math.min((imtVal / 40) * 100, 100)}%"></div>
                    </div>
                `;
                // --- END NEW IMT LOGIC ---

                let extraInfo = '';
                if(allergy) extraInfo += `Алергії: ${allergy}\n`;
                if(health) extraInfo += `Особливості здоров'я: ${health}`;
                document.getElementById('text-info').innerText = extraInfo;

                document.getElementById('sleep-value').innerText = sleepRec;
                document.getElementById('sleep-section').classList.remove('hidden');

                document.getElementById('water-value').innerText = waterRec;
                document.getElementById('water-section').classList.remove('hidden');

                const vitaminInfo = {
                    Vitamin_C:  { name: "Вітамін C", unit: "мг", icon: "lemon", color: "text-orange-500", desc: "Зміцнює імунітет, допомагає загоєнню ран, потрібний для судин і засвоєння заліза" },
                    Vitamin_D:  { name: "Вітамін D", unit: "IU", icon: "sun", color: "text-yellow-500", desc: "Регулює засвоєння кальцію і фосфору, потрібний для міцних кісток та імунітету" },
                    Vitamin_A:  { name: "Вітамін A", unit: "мкг", icon: "eye", color: "text-green-500", desc: "Забезпечує нормальний зір, ріст клітин і здоров’я шкіри та слизових оболонок" },
                    Vitamin_B1: { name: "Вітамін B1", unit: "мг", icon: "bolt", color: "text-red-500", desc: "Необхідний для роботи нервової системи та перетворення їжі на енергію" },
                    Vitamin_B6: { name: "Вітамін B6", unit: "мг", icon: "capsules", color: "text-purple-500", desc: "Бере участь у обміні білків, роботі мозку та утворенні гемоглобіну" },
                    Vitamin_B12:{ name: "Вітамін B12", unit: "мкг", icon: "brain", color: "text-pink-500", desc: "Важливий для кровотворення, нервової системи та синтезу ДНК" }
                };
                
                const vitaminValues = vitamins(age, gender, weight, activity);
                const gridContainer = document.getElementById('vitamin-grid-container');
                
                let cardsHTML = '';
                for (const key in vitaminValues) {
                    const val = vitaminValues[key];
                    const info = vitaminInfo[key];
                    cardsHTML += `
                        <div class="vit-item bg-gray-50 dark:bg-gray-700/50 dark:border-gray-600 border border-gray-100 transition-colors duration-300">
                            <div class="vit-icon-box ${info.color}"><i class="fas fa-${info.icon}"></i></div>
                            <div>
                                <h5 class="font-bold text-sm text-gray-800 dark:text-gray-100">${info.name}</h5>
                                <p class="font-bold text-gray-900 dark:text-white">${val.toFixed(2)} ${info.unit}</p>
                                <h6 class="text-xs text-gray-500 dark:text-gray-400 mt-1">${info.desc}</h6>
                            </div>
                        </div>`;
                }
                gridContainer.innerHTML = cardsHTML;
                document.getElementById('vitamin-section').classList.remove('hidden');

            } catch(err){ console.error(err); }
        }

        // --- 3. ADMIN PANEL LOGIC ---
        let isAdmin = false;
        let selectedElement = null;
        let isDragging = false;
        let isResizing = false;
        let startX, startY, startLeft, startTop, startWidth, startHeight;
        
        const historyStack = [];
        let historyIndex = -1;

        function openAdminAuth() {
            setTimeout(() => {
                const pass = prompt("Пароль:", "Admin_GPT");
                if (pass === "Admin_GPT") toggleAdmin(true);
                else alert("Невірний пароль");
            }, 100);
        }

        function toggleAdmin(active) {
            isAdmin = active;
            const panel = document.getElementById('admin-panel');
            if (active) {
                panel.classList.add('active');
                if (historyStack.length === 0) saveState();
                updateSiteControls();
            } else {
                panel.classList.remove('active');
                deselect();
            }
        }

        function saveState() {
            if (!isAdmin) return;
            const content = document.getElementById('content-area').innerHTML;
            const rootStyle = getComputedStyle(document.documentElement);
            const siteStyles = {
                '--site-color-top': rootStyle.getPropertyValue('--site-color-top'),
                '--site-color-bot': rootStyle.getPropertyValue('--site-color-bot'),
                '--site-gradient-angle': rootStyle.getPropertyValue('--site-gradient-angle')
            };
            historyStack.push({ content, siteStyles });
            historyIndex++;
        }

        function updateSiteGradient() {
            const top = document.getElementById('site-color-top').value;
            const bot = document.getElementById('site-color-bot').value;
            const angle = document.getElementById('site-gradient-angle').value;
            
            document.documentElement.style.setProperty('--site-color-top', top);
            document.documentElement.style.setProperty('--site-color-bot', bot);
            document.documentElement.style.setProperty('--site-gradient-angle', angle + 'deg');
        }

        function updateSiteControls() {
            const style = getComputedStyle(document.documentElement);
            document.getElementById('site-color-top').value = style.getPropertyValue('--site-color-top').trim();
            document.getElementById('site-color-bot').value = style.getPropertyValue('--site-color-bot').trim();
        }

        document.getElementById('site-color-top').oninput = updateSiteGradient;
        document.getElementById('site-color-bot').oninput = updateSiteGradient;
        document.getElementById('site-gradient-angle').oninput = updateSiteGradient;

        document.getElementById('add-card-struct').onclick = () => {
            let grid = document.querySelector('.page-content.active .grid');
            if (!grid) grid = document.getElementById('diag-grid');
            if (!grid) { alert("Не знайдено сітки (grid)."); return; }

            const card = document.createElement('div');
            card.className = 'card'; 
            card.style.setProperty('--card-color-top', '#667eea');
            card.style.setProperty('--card-color-bot', '#764ba2');
            
            card.innerHTML = `
                <img src="https://images.unsplash.com/photo-1579546929518-9e396f3cc809?w=500&auto=format&fit=crop" class="card-image" alt="New">
                <div class="card-content">
                    <h2 class="editable-text">Заголовок</h2>
                    <p class="editable-text">Ваш опис тут.</p>
                </div>
            `;
            grid.appendChild(card);
            saveState();
        };

        document.getElementById('add-hero-banner').onclick = () => createMovableElement('hero', '');
        document.getElementById('add-float-text').onclick = () => createMovableElement('text', 'Ваш текст');
        document.getElementById('add-float-img').onclick = () => {
            const url = prompt("URL:", "https://source.unsplash.com/random/200x200");
            if(url) createMovableElement('img', url);
        };

        function createMovableElement(type, content) {
            const container = document.querySelector('.page-content.active .container') || document.body;
            const box = document.createElement('div');
            box.className = 'movable-box';
            box.style.left = '50px'; box.style.top = '100px';
            
            const inner = document.createElement('div');
            inner.className = 'movable-content';

            if (type === 'text') {
                inner.innerText = content;
                inner.style.padding = '10px';
                inner.style.background = 'white';
                inner.classList.add('editable-text');
                box.style.width = '200px';
            } else if (type === 'img') {
                const img = document.createElement('img');
                img.src = content; img.style.width='100%'; img.style.height='100%';
                inner.appendChild(img);
                box.style.width = '200px'; box.style.height = '200px';
            } else if (type === 'hero') {
                box.style.width = '100%'; box.style.maxWidth = '800px'; box.style.height = '250px';
                inner.classList.add('hero-banner-style'); 
                inner.innerHTML = `
                    <img src="" class="hero-banner-img" style="display: none;">
                    <h2 class="editable-text text-2xl font-bold">Здорове харчування</h2>
                    <p class="editable-text">Ваш шлях до ідеальної форми.</p>
                `;
            }
            
            const handle = document.createElement('div');
            handle.className = 'resize-handle';
            box.appendChild(inner); box.appendChild(handle);
            container.appendChild(box);
            selectElement(box);
            saveState();
        }

        function selectElement(el) {
            if(selectedElement && selectedElement !== el) deselect();
            selectedElement = el;
            
            document.querySelectorAll('.selected-element').forEach(e => e.classList.remove('selected-element'));
            el.classList.add('selected-element');
            document.getElementById('style-controls').classList.add('active');

            document.getElementById('card-style-controls').style.display = 'none';
            document.getElementById('hero-style-controls').style.display = 'none';

            if (el.classList.contains('card')) {
                document.getElementById('card-style-controls').style.display = 'block';
                const topVal = el.style.getPropertyValue('--card-color-top') || '#667eea';
                const botVal = el.style.getPropertyValue('--card-color-bot') || '#764ba2';
                document.getElementById('card-color-top').value = rgbToHex(topVal.trim());
                document.getElementById('card-color-bot').value = rgbToHex(botVal.trim());
                const img = el.querySelector('img');
                if(img) document.getElementById('card-img-url').value = img.src;
            }

            if (el.classList.contains('movable-box') && el.querySelector('.hero-banner-style')) {
                document.getElementById('hero-style-controls').style.display = 'block';
                const heroInner = el.querySelector('.hero-banner-style');
                const hTop = heroInner.style.getPropertyValue('--hero-bg-top') || '#42a5f5';
                const hBot = heroInner.style.getPropertyValue('--hero-bg-bot') || '#26a69a';
                document.getElementById('hero-grad-top').value = rgbToHex(hTop.trim());
                document.getElementById('hero-grad-bot').value = rgbToHex(hBot.trim());
                const heroImg = heroInner.querySelector('.hero-banner-img');
                if (heroImg && heroImg.src && heroImg.style.display !== 'none') {
                    document.getElementById('hero-img-url').value = heroImg.src;
                } else {
                    document.getElementById('hero-img-url').value = '';
                }
            }
        }

        function deselect() {
            if (selectedElement) {
                selectedElement.classList.remove('selected-element');
                if (selectedElement.isContentEditable) selectedElement.contentEditable = "false";
                selectedElement = null;
                document.getElementById('style-controls').classList.remove('active');
            }
        }

        function initFonts() {
            const fonts = ["Montserrat", "Roboto", "Open Sans", "Oswald", "Pacifico", "Lobster", "Comfortaa", "Arial", "Inter", "Poppins", "Lato", "Nunito", "Raleway", "Ubuntu", "Bebas Neue", "Anton", "Playfair Display", "Cinzel", "Dancing Script", "Great Vibes", "Indie Flower"];
            const sel = document.getElementById('font-select');
            fonts.forEach(f => {
                const opt = document.createElement('option');
                opt.value = f; opt.innerText = f;
                sel.appendChild(opt);
            });
        }
        initFonts();

        function rgbToHex(rgb) {
            if(!rgb || rgb.includes('rgba(0, 0, 0, 0)') || rgb === 'transparent') return "#ffffff";
            if(rgb.startsWith('#')) return rgb;
            let sep = rgb.indexOf(",") > -1 ? "," : " ";
            let rgbArr = rgb.substr(4).split(")")[0].split(sep);
            if (rgbArr.length === 4) rgbArr.pop();
            let r = (+rgbArr[0]).toString(16), g = (+rgbArr[1]).toString(16), b = (+rgbArr[2]).toString(16);
            if(r.length==1)r="0"+r; if(g.length==1)g="0"+g; if(b.length==1)b="0"+b;
            return "#" + r + g + b;
        }

        document.addEventListener('mousedown', (e) => {
            if (!isAdmin) return;
            const target = e.target;
            if (target.closest('#admin-panel')) return;

            // 1. Спочатку перевіряємо resize (щоб працювало на будь-якому елементі)
            if (target.classList.contains('resize-handle')) {
                e.preventDefault(); e.stopPropagation(); isResizing = true;
                selectedElement = target.parentElement;
                startX = e.clientX; startY = e.clientY;
                startWidth = selectedElement.offsetWidth; startHeight = selectedElement.offsetHeight;
                return;
            }

            // 2. ПОТІМ перевіряємо текст (це дозволяє редагувати текст ВСЕРЕДИНІ карток)
            if (target.classList.contains('editable-text')) {
                 selectElement(target); 
                 target.contentEditable = "true"; 
                 target.focus(); 
                 return; // Виходимо, щоб не спрацював drag/drop батьківського елемента
            }

            // 3. Рухомі бокси
            const box = target.closest('.movable-box');
            if (box) {
                e.preventDefault(); selectElement(box); isDragging = true;
                startX = e.clientX; startY = e.clientY;
                startLeft = box.offsetLeft; startTop = box.offsetTop;
                return;
            }

            // 4. Картки
            const card = target.closest('.card');
            if(card) { 
                e.preventDefault(); selectElement(card); return; 
            }

            deselect();
        });

        document.addEventListener('mousemove', (e) => {
            if (!isAdmin) return;
            if (isDragging && selectedElement) {
                const dx = e.clientX - startX; const dy = e.clientY - startY;
                selectedElement.style.left = (startLeft + dx) + 'px';
                selectedElement.style.top = (startTop + dy) + 'px';
            }
            if (isResizing && selectedElement) {
                const dx = e.clientX - startX; const dy = e.clientY - startY;
                selectedElement.style.width = (startWidth + dx) + 'px';
                selectedElement.style.height = (startHeight + dy) + 'px';
            }
        });

        document.addEventListener('mouseup', () => { isDragging = false; isResizing = false; });

        function applyStyle(prop, val) {
            if (!selectedElement) return;
            let target = selectedElement;
            if (selectedElement.classList.contains('movable-box')) target = selectedElement.querySelector('.movable-content');
            target.style[prop] = val;
        }

        function updateCSSVar(el, varName, val) { if(!el) return; el.style.setProperty(varName, val); }

        document.getElementById('color-text').oninput = (e) => applyStyle('color', e.target.value);
        document.getElementById('font-size-input').onchange = (e) => applyStyle('fontSize', e.target.value + 'px');
        document.getElementById('font-select').onchange = (e) => applyStyle('fontFamily', e.target.value);
        document.getElementById('color-bg').oninput = (e) => applyStyle('backgroundColor', e.target.value);
        document.getElementById('btn-no-bg').onclick = () => { document.getElementById('color-bg').value='#000000'; applyStyle('backgroundColor', 'transparent'); }
        document.getElementById('btn-delete').onclick = () => { if(selectedElement) selectedElement.remove(); deselect(); };

        document.getElementById('card-color-top').oninput = (e) => updateCSSVar(selectedElement, '--card-color-top', e.target.value);
        document.getElementById('card-color-bot').oninput = (e) => updateCSSVar(selectedElement, '--card-color-bot', e.target.value);
        document.getElementById('card-img-url').oninput = (e) => {
            if (!selectedElement || !selectedElement.classList.contains('card')) return;
            const img = selectedElement.querySelector('img');
            if(img && e.target.value.trim() !== "") img.src = e.target.value;
        };

        document.getElementById('hero-grad-top').oninput = (e) => {
            const inner = selectedElement.querySelector('.hero-banner-style');
            updateCSSVar(inner, '--hero-bg-top', e.target.value);
        };
        document.getElementById('hero-grad-bot').oninput = (e) => {
            const inner = selectedElement.querySelector('.hero-banner-style');
            updateCSSVar(inner, '--hero-bg-bot', e.target.value);
        };
        document.getElementById('hero-img-url').oninput = (e) => {
            const inner = selectedElement.querySelector('.hero-banner-style');
            if (!inner) return;
            let img = inner.querySelector('.hero-banner-img');
            if (e.target.value.trim() !== "") {
                img.src = e.target.value; img.style.display = 'block';
            } else { img.style.display = 'none'; }
        };
        function closeDisclaimer() {
            const overlay = document.getElementById('disclaimer-overlay');
            overlay.style.opacity = '0';
            setTimeout(() => {
                overlay.style.display = 'none';
            }, 500);
        }
    </script>
</body>
</html>